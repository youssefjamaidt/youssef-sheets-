<!-- ... (dans le modal, section par nage : Crawl, Dos, Brasse, Papillon) ... -->

<!-- Onglet CRAWL -->
<div class="tab-content" id="crawl-tab">
    <div class="form-group">
        <label class="form-label">Score Crawl (0-10)</label>
        <input type="number" class="form-control" id="crawlScore" min="0" max="10" step="0.5">
    </div>
    <div class="tech-library">
        <h3>Bibliothèque Technique - CRAWL</h3>
        <p>Sélectionnez les éléments techniques à ajouter à la fiche :</p>
        <div class="tech-category">
            <div class="tech-category-title">
                Points Forts
                <button class="add-tech-btn btn btn-small btn-success" data-category="crawl-strengths-buttons" title="Ajouter un point fort">+</button>
            </div>
            <div class="tech-buttons" id="crawl-strengths-buttons"></div>
        </div>
        <div class="tech-category">
            <div class="tech-category-title">
                Axes d'Amélioration
                <button class="add-tech-btn btn btn-small btn-success" data-category="crawl-improvements-buttons" title="Ajouter un axe d'amélioration">+</button>
            </div>
            <div class="tech-buttons" id="crawl-improvements-buttons"></div>
        </div>
        <div id="crawl-tech-details"></div>
    </div>
    <div class="form-group">
        <label class="form-label">Forces (éditables)</label>
        <textarea class="form-control" id="crawlStrengths" placeholder="Les forces sélectionnées apparaîtront ici. Vous pouvez les modifier."></textarea>
    </div>
    <div class="form-group">
        <label class="form-label">Axes d'amélioration (éditables)</label>
        <textarea class="form-control" id="crawlImprovements" placeholder="Les axes d'amélioration sélectionnées apparaîtront ici. Vous pouvez les modifier."></textarea>
    </div>
    <div class="form-group">
        <label class="form-label">Propositions d'exercices (éditables)</label>
        <textarea class="form-control" id="crawlProposals" placeholder="Les propositions d'exercices sélectionnées apparaîtront ici. Vous pouvez les modifier."></textarea>
    </div>
</div>

<!-- Onglet DOS -->
<div class="tab-content" id="dos-tab">
    <div class="form-group">
        <label class="form-label">Score Dos (0-10)</label>
        <input type="number" class="form-control" id="dosScore" min="0" max="10" step="0.5">
    </div>
    <div class="tech-library">
        <h3>Bibliothèque Technique - DOS</h3>
        <p>Sélectionnez les éléments techniques à ajouter à la fiche :</p>
        <div class="tech-category">
            <div class="tech-category-title">
                Points Forts
                <button class="add-tech-btn btn btn-small btn-success" data-category="dos-strengths-buttons" title="Ajouter un point fort">+</button>
            </div>
            <div class="tech-buttons" id="dos-strengths-buttons"></div>
        </div>
        <div class="tech-category">
            <div class="tech-category-title">
                Axes d'Amélioration
                <button class="add-tech-btn btn btn-small btn-success" data-category="dos-improvements-buttons" title="Ajouter un axe d'amélioration">+</button>
            </div>
            <div class="tech-buttons" id="dos-improvements-buttons"></div>
        </div>
        <div id="dos-tech-details"></div>
    </div>
    <div class="form-group">
        <label class="form-label">Forces (éditables)</label>
        <textarea class="form-control" id="dosStrengths" placeholder="Les forces sélectionnées apparaîtront ici. Vous pouvez les modifier."></textarea>
    </div>
    <div class="form-group">
        <label class="form-label">Axes d'amélioration (éditables)</label>
        <textarea class="form-control" id="dosImprovements" placeholder="Les axes d'amélioration sélectionnées apparaîtront ici. Vous pouvez les modifier."></textarea>
    </div>
    <div class="form-group">
        <label class="form-label">Propositions d'exercices (éditables)</label>
        <textarea class="form-control" id="dosProposals" placeholder="Les propositions d'exercices sélectionnées apparaîtront ici. Vous pouvez les modifier."></textarea>
    </div>
</div>

<!-- Onglet BRASSE -->
<div class="tab-content" id="brasse-tab">
    <div class="form-group">
        <label class="form-label">Score Brasse (0-10)</label>
        <input type="number" class="form-control" id="brasseScore" min="0" max="10" step="0.5">
    </div>
    <div class="tech-library">
        <h3>Bibliothèque Technique - BRASSE</h3>
        <p>Sélectionnez les éléments techniques à ajouter à la fiche :</p>
        <div class="tech-category">
            <div class="tech-category-title">
                Points Forts
                <button class="add-tech-btn btn btn-small btn-success" data-category="brasse-strengths-buttons" title="Ajouter un point fort">+</button>
            </div>
            <div class="tech-buttons" id="brasse-strengths-buttons"></div>
        </div>
        <div class="tech-category">
            <div class="tech-category-title">
                Axes d'Amélioration
                <button class="add-tech-btn btn btn-small btn-success" data-category="brasse-improvements-buttons" title="Ajouter un axe d'amélioration">+</button>
            </div>
            <div class="tech-buttons" id="brasse-improvements-buttons"></div>
        </div>
        <div id="brasse-tech-details"></div>
    </div>
    <div class="form-group">
        <label class="form-label">Forces (éditables)</label>
        <textarea class="form-control" id="brasseStrengths" placeholder="Les forces sélectionnées apparaîtront ici. Vous pouvez les modifier."></textarea>
    </div>
    <div class="form-group">
        <label class="form-label">Axes d'amélioration (éditables)</label>
        <textarea class="form-control" id="brasseImprovements" placeholder="Les axes d'amélioration sélectionnées apparaîtront ici. Vous pouvez les modifier."></textarea>
    </div>
    <div class="form-group">
        <label class="form-label">Propositions d'exercices (éditables)</label>
        <textarea class="form-control" id="brasseProposals" placeholder="Les propositions d'exercices sélectionnées apparaîtront ici. Vous pouvez les modifier."></textarea>
    </div>
</div>

<!-- Onglet PAPILLON -->
<div class="tab-content" id="papillon-tab">
    <div class="form-group">
        <label class="form-label">Score Papillon (0-10)</label>
        <input type="number" class="form-control" id="papillonScore" min="0" max="10" step="0.5">
    </div>
    <div class="tech-library">
        <h3>Bibliothèque Technique - PAPILLON</h3>
        <p>Sélectionnez les éléments techniques à ajouter à la fiche :</p>
        <div class="tech-category">
            <div class="tech-category-title">
                Points Forts
                <button class="add-tech-btn btn btn-small btn-success" data-category="papillon-strengths-buttons" title="Ajouter un point fort">+</button>
            </div>
            <div class="tech-buttons" id="papillon-strengths-buttons"></div>
        </div>
        <div class="tech-category">
            <div class="tech-category-title">
                Axes d'Amélioration
                <button class="add-tech-btn btn btn-small btn-success" data-category="papillon-improvements-buttons" title="Ajouter un axe d'amélioration">+</button>
            </div>
            <div class="tech-buttons" id="papillon-improvements-buttons"></div>
        </div>
        <div id="papillon-tech-details"></div>
    </div>
    <div class="form-group">
        <label class="form-label">Forces (éditables)</label>
        <textarea class="form-control" id="papillonStrengths" placeholder="Les forces sélectionnées apparaîtront ici. Vous pouvez les modifier."></textarea>
    </div>
    <div class="form-group">
        <label class="form-label">Axes d'amélioration (éditables)</label>
        <textarea class="form-control" id="papillonImprovements" placeholder="Les axes d'amélioration sélectionnées apparaîtront ici. Vous pouvez les modifier."></textarea>
    </div>
    <div class="form-group">
        <label class="form-label">Propositions d'exercices (éditables)</label>
        <textarea class="form-control" id="papillonProposals" placeholder="Les propositions d'exercices sélectionnées apparaîtront ici. Vous pouvez les modifier."></textarea>
    </div>
</div>

<!-- ... (à la fin du fichier, avant </body>) ... -->
<script>
document.querySelectorAll('.add-tech-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        const containerId = btn.getAttribute('data-category');
        const container = document.getElementById(containerId);

        // Champ d'entrée
        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'form-control';
        input.placeholder = "Nouveau point fort / axe d'amélioration";
        input.style.marginTop = '6px';
        input.style.display = 'inline-block';
        input.style.width = '60%';

        // Bouton "Valider"
        const validate = document.createElement('button');
        validate.textContent = 'Valider';
        validate.className = 'btn btn-success btn-small';
        validate.style.marginLeft = '8px';

        // Wrapper pour l'entrée
        const wrapper = document.createElement('div');
        wrapper.style.marginBottom = '5px';
        wrapper.appendChild(input);
        wrapper.appendChild(validate);
        container.appendChild(wrapper);

        input.focus();

        validate.onclick = () => {
            if (input.value.trim()) {
                const newItem = document.createElement('div');
                newItem.className = 'tech-item';
                newItem.textContent = input.value;
                container.appendChild(newItem);
            }
            wrapper.remove();
        };

        input.addEventListener('blur', function() {
            setTimeout(() => {
                if (document.activeElement !== validate) {
                    wrapper.remove();
                }
            }, 150);
        });

        input.addEventListener('keydown', (e) => {
            if (e.key === "Enter") validate.click();
            if (e.key === "Escape") wrapper.remove();
        });
    });
});
// ---- AJOUT DYNAMIQUE DU NAGEUR À LA LISTE ----

document.getElementById("saveSwimmerBtn")?.addEventListener("click", function(e) {
    e.preventDefault();

    // Récupère les infos du formulaire
    var name = document.getElementById("swimmerName").value.trim();
    var group = document.getElementById("swimmerGroup").value;
    var crawlScore = parseFloat(document.getElementById("crawlScore").value) || 0;
    var dosScore = parseFloat(document.getElementById("dosScore").value) || 0;
    var brasseScore = parseFloat(document.getElementById("brasseScore").value) || 0;
    var papillonScore = parseFloat(document.getElementById("papillonScore").value) || 0;

    // Calcul du score moyen
    var scores = [crawlScore, dosScore, brasseScore, papillonScore];
    var validScores = scores.filter(s => !isNaN(s) && s > 0);
    var avgScore = validScores.length ? (validScores.reduce((a,b) => a+b, 0)/validScores.length).toFixed(1) : "";

    // Couleur du score
    var scoreClass = "score-medium";
    if (avgScore >= 7) scoreClass = "score-high";
    else if (avgScore < 5) scoreClass = "score-low";

    // Nom du groupe affiché
    var groupLabel = "Compétition";
    if (group === "pre-competition") groupLabel = "Pré-compétition";
    if (group === "apprentissage") groupLabel = "Apprentissage";

    // Trouve le bloc du bon groupe
    var bloc;
    document.querySelectorAll(".swimmer-group").forEach(function(el) {
        if (el.querySelector(".group-title").textContent.includes(groupLabel)) {
            bloc = el;
        }
    });

    if (name && bloc) {
        // Créer le nageur
        var div = document.createElement("div");
        div.className = "swimmer-item";
        div.innerHTML = `<span>${name}</span>
            <span class="score-display ${scoreClass}">${avgScore}</span>`;
        // Option: ajoute un nouvel id data-id ou logic pour sélection/édition, etc.
        // Ajoute à la liste du groupe
        bloc.appendChild(div);

        // Optionnel: fermer le modal, réinitialiser le formulaire !
        document.getElementById("swimmerModal").style.display = "none";
        // Réinitialiser champs:
        document.getElementById("swimmerName").value = "";
        document.getElementById("crawlScore").value = "";
        document.getElementById("dosScore").value = "";
        document.getElementById("brasseScore").value = "";
        document.getElementById("papillonScore").value = "";
        // ... idem pour autres champs

        // Optionnel: reset toutes les sections techniques
        // Optionnel: sélectionne le nouveau nageur (ajouter la classe active etc)
    }
    // else: affiche un message d'erreur si le nom ou le groupe est vide
});
</script>
