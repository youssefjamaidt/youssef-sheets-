<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Système de Fiches Techniques - Natation Compétition</title>
    <style>
        :root {
            --primary: #1a73e8;
            --secondary: #34a853;
            --accent: #fbbc05;
            --danger: #ea4335;
            --light: #f8f9fa;
            --dark: #202124;
            --gray: #5f6368;
            --border: #dadce0;
        }
        * {margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;}
        body {background:#f5f7fa;color:var(--dark);}
        .container {max-width:1400px;margin:0 auto;padding:20px;}
        header {background:linear-gradient(135deg,var(--primary),#0d47a1);color:white;padding:25px 0;border-radius:10px;margin-bottom:30px;box-shadow:0 4px 12px rgba(0, 0, 0, 0.1);text-align:center;}
        h1 {font-size:2.5rem;margin-bottom:10px;}
        .subtitle {font-size:1.2rem;opacity:0.9;}
        .dashboard {display:grid;grid-template-columns:300px 1fr;gap:20px;margin-bottom:30px;}
        .sidebar {background:white;border-radius:10px;box-shadow:0 4px 8px rgba(0,0,0,0.05);padding:20px;height:fit-content;}
        .main-content {background:white;border-radius:10px;box-shadow:0 4px 8px rgba(0,0,0,0.05);padding:20px;}
        .card {background:white;border-radius:10px;box-shadow:0 4px 8px rgba(0,0,0,0.05);margin-bottom:25px;overflow:hidden;transition:transform 0.3s,box-shadow 0.3s;}
        .card:hover {transform:translateY(-5px);box-shadow:0 8px 16px rgba(0,0,0,0.1);}
        .card-header {background:var(--primary);color:white;padding:15px 20px;font-size:1.3rem;font-weight:600;display:flex;justify-content:space-between;align-items:center;}
        .card-body {padding:20px;}
        .swimmer-list {max-height:500px;overflow-y:auto;}
        .swimmer-item {padding:12px 15px;border-bottom:1px solid var(--border);cursor:pointer;transition:background-color 0.2s;display:flex;justify-content:space-between;align-items:center;}
        .swimmer-item:hover {background:rgba(26,115,232,0.05);}
        .swimmer-item.active {background:rgba(26,115,232,0.1);border-left:4px solid var(--primary);}
        .swimmer-group {margin-bottom:20px;}
        .group-title {font-weight:600;color:var(--gray);margin-bottom:10px;padding-bottom:5px;border-bottom:1px solid var(--border);}
        .score-display {display:inline-flex;align-items:center;justify-content:center;width:50px;height:50px;border-radius:50%;font-weight:bold;font-size:1.2rem;color:white;}
        .score-high {background:var(--secondary);}
        .score-medium {background:var(--accent);}
        .score-low {background:var(--danger);}
        .form-group {margin-bottom:15px;}
        .form-label {display:block;margin-bottom:5px;font-weight:600;color:var(--gray);}
        .form-control {width:100%;padding:10px;border:1px solid var(--border);border-radius:6px;font-size:1rem;}
        textarea.form-control {min-height:100px;resize:vertical;}
        .btn {padding:10px 20px;border:none;border-radius:6px;font-weight:600;cursor:pointer;transition:all 0.3s;}
        .btn-primary {background:var(--primary);color:white;}
        .btn-secondary {background:var(--light);color:var(--dark);border:1px solid var(--border);}
        .btn-success {background:var(--secondary);color:white;}
        .btn-danger {background:var(--danger);color:white;}
        .btn-small {padding:6px 12px;font-size:0.9rem;}
        .btn:hover {opacity:0.9;transform:translateY(-2px);}
        .tech-library {background:rgba(26,115,232,0.05);border-radius:8px;padding:15px;margin-bottom:20px;}
        .tech-category {margin-bottom:15px;}
        .tech-category-title {font-weight:600;margin-bottom:10px;color:var(--primary);}
        .tech-buttons {display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px;}
        .tech-item {background:white;border:1px solid var(--border);border-radius:20px;padding:8px 15px;font-size:0.9rem;cursor:pointer;transition:all 0.2s;}
        .tech-item:hover,.tech-item.active{background:var(--primary);color:white;}
        .notes-section {background:rgba(26,115,232,0.05);padding:15px;border-radius:8px;margin-top:20px;}
        .add-tech-btn {margin-left:10px;font-size:1rem;padding:4px 10px;vertical-align:middle;}
        .tabs {display:flex;border-bottom:1px solid var(--border);margin-bottom:20px;}
        .tab {padding:10px 20px;cursor:pointer;border-bottom:3px solid transparent;}
        .tab.active {border-bottom:3px solid var(--primary);font-weight:600;}
        .tab-content {display:none;}
        .tab-content.active {display:block;}
        .modal {display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1000;align-items:center;justify-content:center;}
        .modal-content {background:white;border-radius:10px;width:95%;max-width:900px;max-height:90vh;overflow-y:auto;padding:20px;box-shadow:0 5px 15px rgba(0,0,0,0.2);}
        .modal-header {display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:15px;border-bottom:1px solid var(--border);}
        .modal-title {font-size:1.5rem;font-weight:600;}
        .close {font-size:1.5rem;cursor:pointer;color:var(--gray);}
        footer {text-align:center;margin-top:40px;padding:20px;color:var(--gray);font-size:0.9rem;}
        @media (max-width:768px){.dashboard{grid-template-columns:1fr;}h1{font-size:2rem;}.card-header{flex-direction:column;gap:10px;}.tabs{flex-direction:column;}.tab{padding:8px 15px;}}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Système de Fiches Techniques</h1>
            <p class="subtitle">Gestion individualisée pour tous les nageurs du club</p>
        </header>
        <div class="dashboard">
            <div class="sidebar">
                <div class="card">
                    <div class="card-header">
                        <span>Liste des Nageurs</span>
                        <button class="btn btn-success" id="addSwimmerBtn">+ Ajouter</button>
                    </div>
                    <div class="card-body">
                        <div class="swimmer-list">
                            <div class="swimmer-group" id="competition-group">
                                <div class="group-title">Compétition (<span class="comp-count">0</span>)</div>
                            </div>
                            <div class="swimmer-group" id="pre-competition-group">
                                <div class="group-title">Pré-compétition (<span class="precomp-count">0</span>)</div>
                            </div>
                            <div class="swimmer-group" id="apprentissage-group">
                                <div class="group-title">Apprentissage (<span class="appr-count">0</span>)</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header"><span>Filtres & Recherche</span></div>
                    <div class="card-body">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Rechercher un nageur..." id="searchSwimmer">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Groupe</label>
                            <select class="form-control" id="filterGroup">
                                <option>Tous les groupes</option>
                                <option>Compétition</option>
                                <option>Pré-compétition</option>
                                <option>Apprentissage</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="main-content">
                <div id="swimmerDetail">
                    <div class="notes-section" id="welcomeNote">
                        <h3>Bienvenue !</h3>
                        <p>Sélectionnez un nageur à gauche pour voir sa fiche technique individualisée.</p>
                    </div>
                </div>
            </div>
        </div>
        <footer>
            <p>Système de Fiches Techniques Individualisées - © 2023 Club de Natation Compétition</p>
        </footer>
    </div>
    <!-- Modal pour ajouter/modifier un nageur -->
    <div class="modal" id="swimmerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Ajouter un nageur</h2>
                <span class="close" id="closeModal">&times;</span>
            </div>
            <div class="tab-container">
                <div class="tabs">
                    <div class="tab active" data-tab="info">Informations générales</div>
                    <div class="tab" data-tab="crawl">Crawl</div>
                    <div class="tab" data-tab="dos">Dos</div>
                    <div class="tab" data-tab="brasse">Brasse</div>
                    <div class="tab" data-tab="papillon">Papillon</div>
                </div>
                <!-- Info tab -->
                <div class="tab-content active" id="info-tab">
                    <div class="form-group">
                        <label class="form-label">Nom complet</label>
                        <input type="text" class="form-control" id="swimmerName">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Groupe</label>
                        <select class="form-control" id="swimmerGroup">
                            <option value="competition">Compétition</option>
                            <option value="pre-competition">Pré-compétition</option>
                            <option value="apprentissage">Apprentissage</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Date d'analyse</label>
                        <input type="date" class="form-control" id="analysisDate">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Entraîneur responsable</label>
                        <input type="text" class="form-control" id="coachName">
                    </div>
                </div>
                <!-- Crawl tab -->
                <div class="tab-content" id="crawl-tab">
                    <div class="form-group">
                        <label class="form-label">Score Crawl (0-10)</label>
                        <input type="number" class="form-control" id="crawlScore" min="0" max="10" step="0.5">
                    </div>
                    <div class="tech-library">
                        <h3>Bibliothèque Technique - CRAWL</h3>
                        <div class="tech-category">
                            <div class="tech-category-title">
                                Points Forts
                                <button class="add-tech-btn btn btn-small btn-success" data-category="crawl-strengths-buttons">+</button>
                            </div>
                            <div class="tech-buttons" id="crawl-strengths-buttons"></div>
                        </div>
                        <div class="tech-category">
                            <div class="tech-category-title">
                                Axes d'Amélioration
                                <button class="add-tech-btn btn btn-small btn-success" data-category="crawl-improvements-buttons">+</button>
                            </div>
                            <div class="tech-buttons" id="crawl-improvements-buttons"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Forces (éditables)</label>
                        <textarea class="form-control" id="crawlStrengths"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Axes d'amélioration (éditables)</label>
                        <textarea class="form-control" id="crawlImprovements"></textarea>
                    </div>
                </div>
                <!-- Dos tab -->
                <div class="tab-content" id="dos-tab">
                    <div class="form-group">
                        <label class="form-label">Score Dos (0-10)</label>
                        <input type="number" class="form-control" id="dosScore" min="0" max="10" step="0.5">
                    </div>
                    <div class="tech-library">
                        <h3>Bibliothèque Technique - DOS</h3>
                        <div class="tech-category">
                            <div class="tech-category-title">
                                Points Forts
                                <button class="add-tech-btn btn btn-small btn-success" data-category="dos-strengths-buttons">+</button>
                            </div>
                            <div class="tech-buttons" id="dos-strengths-buttons"></div>
                        </div>
                        <div class="tech-category">
                            <div class="tech-category-title">
                                Axes d'Amélioration
                                <button class="add-tech-btn btn btn-small btn-success" data-category="dos-improvements-buttons">+</button>
                            </div>
                            <div class="tech-buttons" id="dos-improvements-buttons"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Forces (éditables)</label>
                        <textarea class="form-control" id="dosStrengths"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Axes d'amélioration (éditables)</label>
                        <textarea class="form-control" id="dosImprovements"></textarea>
                    </div>
                </div>
                <!-- Brasse tab -->
                <div class="tab-content" id="brasse-tab">
                    <div class="form-group">
                        <label class="form-label">Score Brasse (0-10)</label>
                        <input type="number" class="form-control" id="brasseScore" min="0" max="10" step="0.5">
                    </div>
                    <div class="tech-library">
                        <h3>Bibliothèque Technique - BRASSE</h3>
                        <div class="tech-category">
                            <div class="tech-category-title">
                                Points Forts
                                <button class="add-tech-btn btn btn-small btn-success" data-category="brasse-strengths-buttons">+</button>
                            </div>
                            <div class="tech-buttons" id="brasse-strengths-buttons"></div>
                        </div>
                        <div class="tech-category">
                            <div class="tech-category-title">
                                Axes d'Amélioration
                                <button class="add-tech-btn btn btn-small btn-success" data-category="brasse-improvements-buttons">+</button>
                            </div>
                            <div class="tech-buttons" id="brasse-improvements-buttons"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Forces (éditables)</label>
                        <textarea class="form-control" id="brasseStrengths"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Axes d'amélioration (éditables)</label>
                        <textarea class="form-control" id="brasseImprovements"></textarea>
                    </div>
                </div>
                <!-- Papillon tab -->
                <div class="tab-content" id="papillon-tab">
                    <div class="form-group">
                        <label class="form-label">Score Papillon (0-10)</label>
                        <input type="number" class="form-control" id="papillonScore" min="0" max="10" step="0.5">
                    </div>
                    <div class="tech-library">
                        <h3>Bibliothèque Technique - PAPILLON</h3>
                        <div class="tech-category">
                            <div class="tech-category-title">
                                Points Forts
                                <button class="add-tech-btn btn btn-small btn-success" data-category="papillon-strengths-buttons">+</button>
                            </div>
                            <div class="tech-buttons" id="papillon-strengths-buttons"></div>
                        </div>
                        <div class="tech-category">
                            <div class="tech-category-title">
                                Axes d'Amélioration
                                <button class="add-tech-btn btn btn-small btn-success" data-category="papillon-improvements-buttons">+</button>
                            </div>
                            <div class="tech-buttons" id="papillon-improvements-buttons"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Forces (éditables)</label>
                        <textarea class="form-control" id="papillonStrengths"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Axes d'amélioration (éditables)</label>
                        <textarea class="form-control" id="papillonImprovements"></textarea>
                    </div>
                </div>
                <div style="text-align:right;">
                    <button class="btn btn-success" id="saveSwimmerBtn">Enregistrer</button>
                </div>
            </div>
        </div>
    </div>
<script>
// Onglet modal nageur
document.querySelectorAll(".tab").forEach(tab=>{
    tab.onclick = function() {
        document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
        document.querySelectorAll(".tab-content").forEach(tc=>tc.classList.remove("active"));
        tab.classList.add("active");
        document.getElementById(tab.dataset.tab+"-tab").classList.add("active");
    };
});
// Ouvre/ferme la modale
document.getElementById("addSwimmerBtn").onclick=function(){
    document.getElementById("swimmerModal").style.display="flex";
    document.body.style.overflow='hidden';
};
document.getElementById("closeModal").onclick=function(){
    document.getElementById("swimmerModal").style.display="none";
    document.body.style.overflow='';
};
// Boutons "+" pour ajouter dynamique dans bibliothèque technique
document.querySelectorAll('.add-tech-btn').forEach(btn=>{
    btn.addEventListener('click',function(){
        const containerId=btn.getAttribute('data-category');
        const container=document.getElementById(containerId);
        const input=document.createElement('input');
        input.type='text';
        input.className='form-control';
        input.placeholder="Nouveau point fort / axe";
        input.style.marginTop='6px';
        input.style.display='inline-block';input.style.width='60%';
        const validate=document.createElement('button');
        validate.textContent='Valider';
        validate.className='btn btn-success btn-small';validate.style.marginLeft='8px';
        const wrapper=document.createElement('div');
        wrapper.style.marginBottom='5px';wrapper.appendChild(input);wrapper.appendChild(validate);
        container.appendChild(wrapper);
        input.focus();
        validate.onclick=function(){
            if(input.value.trim()){
                const newItem=document.createElement('div');
                newItem.className='tech-item';
                newItem.textContent=input.value;
                container.appendChild(newItem);
            }
            wrapper.remove();
        };
        input.addEventListener('blur',function(){
            setTimeout(()=>{if(document.activeElement!==validate)wrapper.remove();},150);
        });
        input.addEventListener('keydown',e=>{
            if(e.key==="Enter")validate.click();
            if(e.key==="Escape")wrapper.remove();
        });
    });
});
// Ajout dynamique du nageur
document.getElementById("saveSwimmerBtn").onclick=function(e){
    e.preventDefault();
    let name=document.getElementById("swimmerName").value.trim();
    let group=document.getElementById("swimmerGroup").value;
    let crawlScore=parseFloat(document.getElementById("crawlScore").value)||0;
    let dosScore=parseFloat(document.getElementById("dosScore").value)||0;
    let brasseScore=parseFloat(document.getElementById("brasseScore").value)||0;
    let papillonScore=parseFloat(document.getElementById("papillonScore").value)||0;
    let scores=[crawlScore,dosScore,brasseScore,papillonScore];
    let validScores=scores.filter(s=>!isNaN(s)&&s>0);
    let avgScore=validScores.length?(validScores.reduce((a,b)=>a+b,0)/validScores.length).toFixed(1):"";
    let scoreClass="score-medium";
    if(avgScore>=7)scoreClass="score-high";
    else if(avgScore<5)scoreClass="score-low";
    let groupLabel="Compétition", groupDiv="competition-group",counterClass=".comp-count";
    if(group==="pre-competition"){groupLabel="Pré-compétition";groupDiv="pre-competition-group";counterClass=".precomp-count";}
    if(group==="apprentissage"){groupLabel="Apprentissage";groupDiv="apprentissage-group";counterClass=".appr-count";}
    if(name){
        let div=document.createElement("div");
        div.className="swimmer-item";
        div.innerHTML=`<span>${name}</span><span class="score-display ${scoreClass}">${avgScore}</span>`;
        document.getElementById(groupDiv).appendChild(div);
        // Mise à jour du compteur
        let count = document.getElementById(groupDiv).querySelectorAll(".swimmer-item").length;
        document.getElementById(groupDiv).querySelector(counterClass).innerText = count;
        document.getElementById("swimmerModal").style.display="none";
        document.body.style.overflow='';
        document.getElementById("swimmerName").value='';
        document.getElementById("crawlScore").value='';
        document.getElementById("dosScore").value='';
        document.getElementById("brasseScore").value='';
        document.getElementById("papillonScore").value='';
        document.getElementById("analysisDate").value='';
        document.getElementById("coachName").value='';
        // Sélection du nageur et vue fiche détaillée
        document.querySelectorAll('.swimmer-item').forEach(it=>it.classList.remove('active'));
        div.classList.add('active');
        afficherFicheNageur({
            name:name,
            group:groupLabel,
            analysisDate:document.getElementById("analysisDate").value,
            coach:document.getElementById("coachName").value,
            avgScore:avgScore,
            scores:{
                crawl:crawlScore,
                dos:dosScore,
                brasse:brasseScore,
                papillon:papillonScore
            },
            forces:{
                crawl:document.getElementById("crawlStrengths").value,
                dos:document.getElementById("dosStrengths").value,
                brasse:document.getElementById("brasseStrengths").value,
                papillon:document.getElementById("papillonStrengths").value
            },
            axes:{
                crawl:document.getElementById("crawlImprovements").value,
                dos:document.getElementById("dosImprovements").value,
                brasse:document.getElementById("brasseImprovements").value,
                papillon:document.getElementById("papillonImprovements").value
            }
        });
        div.onclick=function(){
            document.querySelectorAll('.swimmer-item').forEach(it=>it.classList.remove('active'));
            div.classList.add('active');
            afficherFicheNageur({name,group:groupLabel, avgScore, scores:{crawl:crawlScore,dos:dosScore,brasse:brasseScore,papillon:papillonScore},forces:{
                crawl:document.getElementById("crawlStrengths").value,
                dos:document.getElementById("dosStrengths").value,
                brasse:document.getElementById("brasseStrengths").value,
                papillon:document.getElementById("papillonStrengths").value
            },axes:{
                crawl:document.getElementById("crawlImprovements").value,
                dos:document.getElementById("dosImprovements").value,
                brasse:document.getElementById("brasseImprovements").value,
                papillon:document.getElementById("papillonImprovements").value
            }});
        };
    }
};
// Affichage fiche technique à droite
function afficherFicheNageur(data){
    document.getElementById("swimmerDetail").innerHTML = `
    <div class="card">
        <div class="card-header"><span>Fiche Technique - ${data.name}</span></div>
        <div class="card-body">
            <div class="swimmer-info">
                <div class="info-group"><span class="info-label">Nom</span><span class="info-value">${data.name}</span></div>
                <div class="info-group"><span class="info-label">Groupe</span><span class="info-value">${data.group}</span></div>
                <div class="info-group"><span class="info-label">Entraîneur</span><span class="info-value">${data.coach||""}</span></div>
                <div class="info-group"><span class="info-label">Date d'analyse</span><span class="info-value">${data.analysisDate||""}</span></div>
                <div class="info-group"><span class="info-label">Score moyen</span><span class="info-value"><div class="score-display">${data.avgScore}/10</div></span></div>
            </div>
            ${["crawl","dos","brasse","papillon"].map(nage=>`
            <div class="stroke-section" style="margin-bottom:15px;">
                <div class="card-header" style="background:var(--primary)">${nage.toUpperCase()} <div class="score-display">${data.scores[nage]||""}/10</div></div>
                <div class="card-body">
                    <div><strong>Points forts:</strong> <br>${(data.forces[nage]||"").replace(/\n/g,"<br>")}</div>
                    <div><strong>Axes d'amélioration:</strong> <br>${(data.axes[nage]||"").replace(/\n/g,"<br>")}</div>
                </div>
            </div>`).join('')}
        </div>
    </div>`;
    document.getElementById("welcomeNote").style.display="none";
}
// Filtre par groupe
document.getElementById("filterGroup").onchange=function(){
    let val = this.value;
    ["competition-group","pre-competition-group","apprentissage-group"].forEach(grp=>{
        let el=document.getElementById(grp);
        if(val==="Tous les groupes" || el.querySelector('.group-title').textContent.includes(val)) el.style.display="";
        else el.style.display="none";
    });
};
// Search nageurs (filtre par nom)
document.getElementById("searchSwimmer").oninput=function(){
    let txt = this.value.toLowerCase();
    document.querySelectorAll('.swimmer-item').forEach(it=>{
        let name = it.querySelector('span').textContent.toLowerCase();
        it.style.display = name.includes(txt)?'':'none';
    });
};
</script>
</body>
</html>
